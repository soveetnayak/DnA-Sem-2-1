SELECT WORD, AVG( SCORE ) AS AvgScore FROM (SELECT WORD, FREQ/TotalWords AS SCORE, DOC_ID FROM ( SELECT WORD, FREQ, TotalWords, INVINDEX.DOC_ID FROM INVINDEX, ( SELECT SUM(FREQ) AS TotalWords , DOC_ID FROM INVINDEX GROUP BY DOC_ID ) AS Table1 WHERE INVINDEX.DOC_ID=Table1.DOC_ID )AS Table2 ) AS Table3 GROUP BY WORD ORDER BY AvgScore DESC;